#!/bin/false
# $Id:$

# Graph the DNS stats as yielded via the 'capture-dns-stats' script

package Grapture::Discovery::EXTEND_DNS;

use strict;
use warnings;

sub discover {

    [
        {    #IPv4 requests received by DNS process
            'metric'      => 'IPv4_Requests',
            'device'      => 'Network',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.1',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #EDNS requests
            'metric'      => 'EDNS_Received',
            'device'      => 'EDNS',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.2',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #TCP requests received
            'metric'      => 'TCP_Requests',
            'device'      => 'Network',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.3',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 20,
            'aggregate'   => 'true',
        },
        {    #Rejected update requests
            'metric'      => 'Rejected_Updates',
            'device'      => 'Updates',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.4',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Responses sent
            'metric'      => 'Responses_Sent',
            'device'      => 'Responses',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.5',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Truncated Responses
            'metric'      => 'Truncated_Responses',
            'device'      => 'Responses',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.6',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 20,
            'aggregate'   => 'true',
        },
        {    #EDNS Responses
            'metric'      => 'EDNS_Responses',
            'device'      => 'Responses',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.7',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 30,
            'aggregate'   => 'true',
        },
        {    #Queries Successful
            'metric'      => 'Successful',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.8',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Authoritive
            'metric'      => 'Authoritive',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.9',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Non-Authoritive
            'metric'      => 'Successful',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.10',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Referred
            'metric'      => 'Referrals',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.11',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries nxrrset
            'metric'      => 'nxrrset',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.12',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Servfail
            'metric'      => 'Servfail',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.13',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Formerr
            'metric'      => 'Form_Error',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.14',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries NXDOMAIN
            'metric'      => 'NXDomain',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.15',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries recursion
            'metric'      => 'Recursive',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.16',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Duplicates
            'metric'      => 'Duplicates',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.17',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Dropped
            'metric'      => 'Dropped',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.18',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Failed
            'metric'      => 'Failed',
            'device'      => 'Query Results',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.19',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
        {    #Queries Servfail
            'metric'      => 'Failed',
            'device'      => 'Updates',
            'valbase'     => '1.3.6.1.4.1.8072.1.3.2.4.1.2.8.100.110.115.115.116.97.116.115.20',
            'counterbits' => '64',
            'category'    => 'DNS Stats',
            'valtype'     => 'derive',
            'graphorder'  => 10,
            'aggregate'   => 'true',
        },
    ];
}

1;
